language: node_js
node_js:
  - 14

jobs:
  include:
    - stage: weather
      script:
        - cd weather-service
        - cp .env.travis .env
        - npm install
        - npm run test
    - stage: rocket
      script:
        - cd rocket-service
        - cp .env.travis .env
        - npm install
        - npm run test
    - stage: command
      script:
        - cd mission-service
        - cp .env.travis .env
        - npm install
        - npm run test
    - stage: client #Run cucumber (todo do only on master)
      script:
        - docker-compose build
        - docker-compose up -d
      after-script:
        - docker-compose kill
      if: branch = master

notifications:
  slack: informatiquep-kyw7477:InXvtw4L5aLweMKgjOygoiZB